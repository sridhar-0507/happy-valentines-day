<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Surprise</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; font-family: 'Poppins', sans-serif; }

body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(135deg, #fbc2eb, #a6c1ee);
  overflow: hidden;
  text-align: center;
}

.container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,255,255,0.95);
  padding: 30px 20px;
  border-radius: 20px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.15);
  width: 90%;
  max-width: 420px;
  text-align: center;
}

.hidden { opacity: 0; pointer-events: none; transform: scale(0.9); }

.buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 15px;
  margin-top: 20px;
  position: relative;
}

button {
  padding: 12px 25px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  font-size: 1rem;
  min-width: 100px;
  color: white;
  box-shadow: 0 10px 25px rgba(255,126,179,0.4);
  transition: all 0.3s ease;
}

#yesBtn { background: #ff7eb3; }
#noBtn { background: #b388ff; }

#valentineReveal { display: none; margin-top: 25px; }

#valentineReveal img {
  width: 100%;
  max-width: 260px;
  border-radius: 18px;
  margin-bottom: 15px;
  animation: glow 2s infinite alternate, popIn 0.6s ease forwards;
}

#typeText {
  color: #ff4f91;
  font-size: 1.2rem;
  min-height: 2.5em;
  word-wrap: break-word;
}

@keyframes glow {
  from { box-shadow: 0 0 15px #ff7eb3, 0 0 30px #ff7eb3; }
  to { box-shadow: 0 0 25px #ff4f91, 0 0 50px #ff4f91; }
}

@keyframes popIn {
  0% { transform: scale(0.5); opacity: 0; }
  70% { transform: scale(1.1); }
  100% { transform: scale(1); opacity: 1; }
}

@media (max-width:480px){
  .container { padding: 25px 15px; }
  h1 { font-size: 1.6rem; }
  button { font-size: 0.9rem; padding: 10px 20px; }
  #valentineReveal img { max-width: 200px; }
  #typeText { font-size: 1rem; }
}

canvas {
  position: fixed;
  inset: 0;
  pointer-events: none;
  width: 100%;
  height: 100%;
}
</style>
</head>

<body>

<canvas id="confetti"></canvas>
<canvas id="sparkles"></canvas>

<audio id="music" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5e3d9bfb5c.mp3"></audio>
<audio id="pop" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_1c3b36c6c3.mp3"></audio>
<audio id="bang" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/01/18/audio_b7b9bcbf28.mp3"></audio>

<!-- 404 Screen -->
<div class="container" id="errorScreen">
  <h1>404</h1>
  <p>Oops! Page Not Found üíî</p>
  <button id="refreshBtn">Refresh</button>
</div>

<!-- Valentine Screen -->
<div class="container hidden" id="valentineScreen">
  <h1 id="title">Will you be my Valentine? üíò</h1>

  <div class="buttons" id="buttons">
    <button id="yesBtn">YES</button>
    <button id="noBtn">NO</button>
  </div>

  <div id="valentineReveal">
    <img src="val.jpeg" alt="Valentine">
    <div id="typeText"></div>
  </div>
</div>

<script>
const errorScreen = document.getElementById('errorScreen');
const valentineScreen = document.getElementById('valentineScreen');
const refreshBtn = document.getElementById('refreshBtn');
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const buttons = document.getElementById('buttons');
const reveal = document.getElementById('valentineReveal');
const typeText = document.getElementById('typeText');
const title = document.getElementById('title');

const music = document.getElementById('music');
const pop = document.getElementById('pop');
const bang = document.getElementById('bang');

const noMessages = [
  "Wait‚Ä¶ what if this makes you smile? üòè",
  "Okay but hear me out‚Ä¶ üí≠",
  "Just imagine how cute this could be üíñ",
  "This button wouldn‚Äôt run if it wasn‚Äôt worth it üëÄ",
  "Your future self is already smiling ü•∞",
  "I promise there‚Äôs something special behind YES ‚ú®",
  "Don‚Äôt you want to see what happens next? üòå",
  "This is your sign‚Ä¶ yes, THIS one üí´",
  "Curiosity looks good on you üòò",
  "Alright‚Ä¶ I might be falling here ‚ù§Ô∏è",
  "You‚Äôre still here‚Ä¶ that means something üíû",
  "At this point, we both know the answer üò≠‚ù§Ô∏è"
];

let noClicks = 0;

// 404 ‚Üí Valentine
refreshBtn.onclick = () => {
  errorScreen.classList.add('hidden');
  setTimeout(() => valentineScreen.classList.remove('hidden'), 500);
};

// YES
yesBtn.onclick = () => {
  music.play();
  pop.play();
  setTimeout(() => bang.play(), 300);

  if (navigator.vibrate) navigator.vibrate([200, 100, 200]);

  reveal.style.display = 'block';
  typeWriter("Happy Valentine‚Äôs Day, my dear love ‚ù§Ô∏è");

  setTimeout(() => {
    buttons.style.opacity = 0;
    buttons.style.pointerEvents = 'none';
  }, 1000);

  startConfetti(5000);
  sparkleBurst();

  // Open WhatsApp with prefilled message
  //const message = encodeURIComponent("I love you ‚ù§Ô∏è");
  //const whatsappURL = `https://wa.me/?text=${message}`;
  //window.open(whatsappURL, "_blank");
};

// NO button smooth dodge + scaling + avoid overlapping YES
function moveNoBtn() {
  const btnWidth = noBtn.offsetWidth;
  const btnHeight = noBtn.offsetHeight;
  const yesRect = yesBtn.getBoundingClientRect();
  const containerRect = valentineScreen.getBoundingClientRect();

  let left, top;
  let tries = 0;

  do {
    left = Math.random() * (containerRect.width - btnWidth);
    top = Math.random() * (containerRect.height - btnHeight);
    tries++;
  } while (
    left < yesRect.right - containerRect.left &&
    left + btnWidth > yesRect.left - containerRect.left &&
    top < yesRect.bottom - containerRect.top &&
    top + btnHeight > yesRect.top - containerRect.top &&
    tries < 100
  );

  noBtn.style.position = 'absolute';
  noBtn.style.left = left + 'px';
  noBtn.style.top = top + 'px';

  // Display no message, stick to last if exceeded
  const msgIndex = Math.min(noClicks, noMessages.length - 1);
  title.textContent = noMessages[msgIndex];

  // Scale YES button up
  yesBtn.style.transform = `scale(${1 + noClicks * 0.05})`;

  // Shrink NO button after last message
  if (noClicks >= noMessages.length - 1) {
    const shrinkAmount = Math.pow(0.95, noClicks - noMessages.length + 2);
    noBtn.style.transform = `scale(${shrinkAmount})`;
  } else {
    noBtn.style.transform = `scale(1)`;
  }

  noClicks++;
}

noBtn.onclick = moveNoBtn;
noBtn.ontouchstart = moveNoBtn;

// Typewriter
function typeWriter(text, i = 0) {
  if (i < text.length) {
    typeText.textContent += text.charAt(i);
    setTimeout(() => typeWriter(text, i + 1), 70);
  }
}

// Confetti
const canvas = document.getElementById('confetti');
const ctx = canvas.getContext('2d');
canvas.width = innerWidth;
canvas.height = innerHeight;

function startConfetti(duration) {
  const hearts = Array.from({length:120}, () => ({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height - canvas.height,
    s: Math.random()*12+10,
    v: Math.random()*3+2
  }));

  const start = Date.now();
  (function anim(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    hearts.forEach(h=>{
      h.y+=h.v;
      drawHeart(h.x,h.y,h.s);
    });
    if(Date.now()-start<duration) requestAnimationFrame(anim);
  })();
}

function drawHeart(x,y,s){
  ctx.fillStyle="#ff4f91";
  ctx.beginPath();
  ctx.moveTo(x,y);
  ctx.bezierCurveTo(x-s/2,y-s/2,x-s,y+s/3,x,y+s);
  ctx.bezierCurveTo(x+s,y+s/3,x+s/2,y-s/2,x,y);
  ctx.fill();
}

// Sparkles
const sCanvas = document.getElementById('sparkles');
const sCtx = sCanvas.getContext('2d');
sCanvas.width = innerWidth;
sCanvas.height = innerHeight;

function sparkleBurst() {
  const sparks = Array.from({length:80}, () => ({
    x: innerWidth/2,
    y: innerHeight/2,
    vx: (Math.random()-0.5)*6,
    vy: (Math.random()-0.5)*6,
    life: 60
  }));

  (function anim(){
    sCtx.clearRect(0,0,sCanvas.width,sCanvas.height);
    sparks.forEach(p=>{
      p.x+=p.vx;
      p.y+=p.vy;
      p.life--;
      sCtx.fillStyle=`rgba(255,215,0,${p.life/60})`;
      sCtx.fillRect(p.x,p.y,3,3);
    });
    if(sparks.some(p=>p.life>0)) requestAnimationFrame(anim);
    else sCtx.clearRect(0,0,sCanvas.width,sCanvas.height);
  })();
}
</script>

</body>
</html>
